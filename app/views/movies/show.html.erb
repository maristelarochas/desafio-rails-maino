<div class="max-w-4xl mx-auto">
  <div class="bg-white rounded-lg shadow-md p-8">
    <div class="flex justify-between items-start mb-6">
      <h1 class="text-4xl font-bold text-gray-900"><%= @movie.title %></h1>
      <% if user_signed_in? %>

      <% if @movie.poster.attached? %>
      <div class="mb-6">
        <%= image_tag @movie.poster, class: "w-full max-w-md rounded-lg shadow-lg mx-auto" %>
      </div>
    <% end %>

      <% if user_signed_in? && @movie.user == current_user %>
        <div class="flex space-x-2">
          <%= link_to "Editar", edit_movie_path(@movie), class: "bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700" %>
          <%= button_to "Excluir", @movie, method: :delete, data: { confirm: "Tem certeza?" }, class: "bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700" %>
        </div>
      <% end %>
    </div>
  </div>
  <div class="mt-12">
    <h2 class="text-2xl font-semibold text-gray-800 mb-4">Comentários</h2>
    <div class="space-y-4">
      <% @movie.comments.each do |comment| %>
        <div class="bg-gray-100 p-4 rounded-lg">
          <p class="text-gray-700"><%= comment.content %></p>
          <p class="text-sm text-gray-500 mt-2">Por <%= comment.user.email %> em <%= comment.created_at.strftime("%d/%m/%Y %H:%M") %></p>
        </div>
      <% end %>
    </div>

    <% if user_signed_in? %>
      <div class="mt-6">
        <h3 class="text-xl font-semibold text-gray-800 mb-2">Adicionar Comentário</h3>
        <%= form_with(model: [@movie, Comment.new], local: true) do |form| %>
          <div class="mb-4">
            <%= form.text_area :content, class: "w-full p-2 border border-gray-300 rounded", rows: 4, placeholder: "Escreva seu comentário aqui..." %>
          </div>
          <div>
            <%= form.submit "Enviar Comentário", class: "bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700" %>
          </div>
        <% end %>
      </div>
    <% else %>
      <p class="text-gray-600">Por favor, <a href="<%= new_user_session_path %>" class="text-blue-600 underline">faça login</a> para adicionar um comentário.</p>
    <% end %>
</div>
